"use strict";(self.webpackChunkai_tools_website_frontend=self.webpackChunkai_tools_website_frontend||[]).push([[783],{7783:(e,t,o)=>{o.r(t),o.d(t,{default:()=>N});var r=o(5043),i=o(3216),n=o(5475),a=o(6376),s=o(6213),l=o(4558),d=o(6625),c=o(4383),u=o(2115),p=(o(2342),o(6636)),h=o(8261),m=o(3248),g=o(5950),x=o(579);const b=()=>{const e={backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"4px",marginBottom:"12px",animation:"pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite"};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("style",{children:"\n    @keyframes pulse {\n      0%, 100% {\n        opacity: 1;\n      }\n      50% {\n        opacity: .5;\n      }\n    }\n  "})," ",(0,x.jsxs)("div",{style:{width:"100%",minHeight:"100vh",backgroundColor:"var(--bg-base-color)",backgroundImage:"var(--bg-gradient)",padding:"20px",boxSizing:"border-box",color:"white"},"aria-busy":"true","aria-live":"polite",role:"status","aria-label":"\u6b63\u5728\u52a0\u8f7d\u5e16\u5b50\u8be6\u60c5...",children:[(0,x.jsx)("div",{style:{...e,height:"36px",width:"75%",marginBottom:"24px"}}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"24px"},children:[(0,x.jsx)("div",{style:{...e,width:"40px",height:"40px",borderRadius:"50%",marginRight:"12px"}}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{style:{...e,height:"16px",width:"120px",marginBottom:"6px"}}),(0,x.jsx)("div",{style:{...e,height:"12px",width:"80px"}})]})]}),(0,x.jsx)("div",{style:{...e,height:"20px",width:"100%"}}),(0,x.jsx)("div",{style:{...e,height:"20px",width:"100%"}}),(0,x.jsx)("div",{style:{...e,height:"20px",width:"90%"}}),(0,x.jsx)("div",{style:{...e,height:"20px",width:"95%",marginBottom:"30px"}}),(0,x.jsx)("div",{style:{...e,height:"28px",width:"40%",marginBottom:"16px"}}),(0,x.jsx)("div",{style:{...e,height:"60px",width:"100%"}})]})]})};var y=o(349),f=(o(119),o(1502)),v=o(8027),w=o(953);const N=()=>{var e,t,o,N,E,k;const{postSlug:$=""}=(0,i.g)(),T=(0,i.Zp)(),{isSidebarOpen:j}=(0,p.c)(),{token:C,user:_}=(0,d.A)(),[A,S]=(0,r.useState)(0),[P,D]=(0,r.useState)(!1),[L,M]=(0,r.useState)(!1),[q,V]=(0,r.useState)(""),[F,I]=(0,r.useState)(null),[R,O]=(0,r.useState)(!1),B=(0,r.useRef)(null),X=(0,m.jE)(),[z,W]=(0,r.useState)(null),[H,U]=(0,r.useState)(!1),{data:J,isLoading:Z,isError:K,error:Y}=((e,t)=>{const o=["postDetails",e];return(0,h.I)({queryKey:o,queryFn:async()=>{if(!e)throw new Error("\u65e0\u6548\u7684\u5e16\u5b50\u6807\u8bc6\u7b26");console.log(`[usePostDetails][Page] Fetching data for post slug: ${e}`);const o={};t&&(o.Authorization=`Bearer ${t}`);const r=`${l.JR}/api/posts/slug/${e}`;console.log(`[usePostDetails][Page][DEBUG] Fetching Post from: ${r}`);const i=await s.A.get(r,{headers:o});return console.log("[usePostDetails][Page] Post Data:",i.data),i.data},enabled:!!e,staleTime:3e5,gcTime:9e5,retry:(e,t)=>{var o;return 404===(null===t||void 0===t||null===(o=t.response)||void 0===o?void 0:o.status)?(console.warn("[usePostDetails][Page] Post not found (404), not retrying."),!1):(console.warn(`[usePostDetails][Page] Fetch failed (attempt ${e+1}), retrying... Error:`,t.message),e<2)}})})($,C),G=(0,g.$)(),Q=(0,g.E)(),ee=K?(Y instanceof Error?Y.message:String(Y))||"\u65e0\u6cd5\u52a0\u8f7d\u5e16\u5b50\u5185\u5bb9\u3002":null;(0,r.useEffect)((()=>{if(null!==J&&void 0!==J&&J.content){const e=J.content.match(/!\[(.*?)\]\((https?:\/\/[^)]+)\)/g);e&&e.forEach(((e,t)=>{console.log(`\u56fe\u7247${t+1}:`,e)}));te(J.content)}}),[null===J||void 0===J?void 0:J.content]),(0,r.useEffect)((()=>{var e;J?(D(!(!_||(null===(e=J.author)||void 0===e?void 0:e.id)!==_.id)),S(J.share_count||0)):(D(!1),S(0))}),[J,_]),(0,r.useEffect)((()=>{if(null!==J&&void 0!==J&&J.content&&B.current){B.current.querySelectorAll("iframe").forEach((e=>{var t;if(null!==(t=e.parentElement)&&void 0!==t&&t.classList.contains("video-processed"))return;const o=e.parentElement;if(!o)return;o instanceof HTMLElement&&(o.style.cssText="",o.className="");const r=document.createElement("div");if(r.className="video-container video-processed",r.style.cssText="width: 100%; max-width: 800px; margin: 2em auto; position: relative; aspect-ratio: 16/9; background: #000; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); overflow: hidden;",e instanceof HTMLIFrameElement&&(e.style.cssText="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 12px;"),o.parentElement){const t=document.createElement("div");t.className="not-prose",t.style.cssText="all: initial; display: block; text-align: center; width: 100%; margin: 2em 0; font-family: inherit; color: inherit;",r.appendChild(e.cloneNode(!0)),t.appendChild(r),o.parentElement.replaceChild(t,o)}}));B.current.querySelectorAll("img").forEach((e=>{const t=e.getAttribute("src");t&&t.includes("synspirit-test-1313131901.cos.ap-shanghai.myqcloud.com")&&(e.src=`/api/upload/proxy/image?url=${encodeURIComponent(t)}`,e.onerror=()=>{console.warn(`\u56fe\u7247\u4ee3\u7406\u52a0\u8f7d\u5931\u8d25: ${t}`)}),""===e.style.maxWidth&&(e.style.maxWidth="100%"),""===e.style.margin&&(e.style.margin="10px auto"),""===e.style.display&&(e.style.display="block")}));B.current.querySelectorAll("*").forEach((e=>{e.childNodes&&e.childNodes.length>0&&e.childNodes.forEach((e=>{if(e.nodeType===Node.TEXT_NODE&&e.textContent){const o=e.textContent,r=/!\[(.*?)\]\((https?:\/\/[^)]+)\)/g;let i,n=!1,a=0;const s=document.createDocumentFragment();for(;null!==(i=r.exec(o));){n=!0;const e=i.index,t=e+i[0].length;e>a&&s.appendChild(document.createTextNode(o.substring(a,e)));const r=document.createElement("img"),l=i[2];console.log(`(useEffect PostDetail) \u5904\u7406Markdown\u56fe\u7247: ${l.substring(0,50)}${l.length>50?"...":""}`),r.setAttribute("data-original-src",l),r.src=(0,w.o6)(l),r.alt=i[1],r.className="markdown-image",r.style.maxWidth="100%",r.style.margin="10px auto",r.style.display="block",r.onerror=()=>((0,w.Mq)(l,r),!0),s.appendChild(r),a=t}var t;if(n)a<o.length&&s.appendChild(document.createTextNode(o.substring(a))),null===(t=e.parentNode)||void 0===t||t.replaceChild(s,e)}}))}))}}),[null===J||void 0===J?void 0:J.content,w.o6]),(0,r.useEffect)((()=>{if(null!==J&&void 0!==J&&J.content&&B.current){const e=e=>{let t=e.nodeValue||"";const o=/\$\$latex\s*([\s\S]*?)\s*\$\$/g,r=/\$\$([\s\S]*?)\$\$/g,i=document.createDocumentFragment();let n,a=0,s=!1;for(;null!==(n=o.exec(t));){s=!0;const e=n.index,o=e+n[0].length;e>a&&i.appendChild(document.createTextNode(t.substring(a,e)));const r=n[1].trim(),l=document.createElement("span");l.className="latex-rendered-block";try{y.Ay.render(r,l,{throwOnError:!1,displayMode:!0}),i.appendChild(l)}catch(d){console.error("LaTeX\u6e32\u67d3\u9519\u8bef:",d,"\u539f\u59cb\u6587\u672c:",n[0]);const e=document.createElement("span");e.innerHTML='<span style="color: red;">LaTeX\u6e32\u67d3\u9519\u8bef</span>',i.appendChild(e)}a=o}if(r.lastIndex=0,!s)for(a=0;null!==(n=r.exec(t));){s=!0;const e=n.index,o=e+n[0].length;e>a&&i.appendChild(document.createTextNode(t.substring(a,e)));const r=n[1].trim(),l=document.createElement("span");l.className="latex-rendered-block";try{y.Ay.render(r,l,{throwOnError:!1,displayMode:!0}),i.appendChild(l)}catch(d){console.error("LaTeX\u6e32\u67d3\u9519\u8bef:",d,"\u539f\u59cb\u6587\u672c:",n[0]);const e=document.createElement("span");e.innerHTML='<span style="color: red;">LaTeX\u6e32\u67d3\u9519\u8bef</span>',i.appendChild(e)}a=o}var l;(a<t.length&&i.appendChild(document.createTextNode(t.substring(a))),s)&&(null===(l=e.parentNode)||void 0===l||l.replaceChild(i,e))},t=new MutationObserver((t=>{t.forEach((t=>{t.addedNodes.forEach((t=>{t.nodeType===Node.TEXT_NODE?t.nodeValue&&(t.nodeValue.includes("$$")||t.nodeValue.includes("$latex"))&&e(t):t.nodeType===Node.ELEMENT_NODE&&(t.querySelectorAll(":scope > *:not(script):not(style)").forEach((t=>{t.childNodes.forEach((t=>{t.nodeType===Node.TEXT_NODE&&t.nodeValue&&(t.nodeValue.includes("$$")||t.nodeValue.includes("$latex"))&&e(t)}))})),t.childNodes.forEach((t=>{t.nodeType===Node.TEXT_NODE&&t.nodeValue&&(t.nodeValue.includes("$$")||t.nodeValue.includes("$latex"))&&e(t)})))}))}))})),o=t=>{if(t.nodeType===Node.TEXT_NODE&&t.nodeValue&&(t.nodeValue.includes("$$")||t.nodeValue.includes("$latex")))e(t);else if(t.nodeType===Node.ELEMENT_NODE){var r,i;null!==(r=t.classList)&&void 0!==r&&r.contains("katex")||null!==(i=t.classList)&&void 0!==i&&i.contains("katex-html")||"SCRIPT"===t.nodeName||"STYLE"===t.nodeName||t.childNodes.forEach(o)}};if(B.current){B.current.childNodes.forEach(o),t.observe(B.current,{childList:!0,subtree:!0});(()=>{if(!B.current)return;B.current.querySelectorAll("img").forEach((e=>{const t=e.getAttribute("src"),o=e.getAttribute("data-original-src");if(o){const t=(0,w.o6)(o);e.src!==t&&(console.log(`(PostDetailPage useEffect) Correcting src for ${o.substring(0,50)}... to ${t.substring(0,50)}...`),e.src=t,e.onerror=()=>((0,w.Mq)(o,e),!0))}else t&&t.startsWith("http")&&(console.log(`(PostDetailPage useEffect) Initial processing for ${t.substring(0,50)}...`),e.setAttribute("data-original-src",t),e.src=(0,w.o6)(t),e.onerror=()=>((0,w.Mq)(t,e),!0));""===e.className&&(e.className="markdown-image"),""===e.style.maxWidth&&(e.style.maxWidth="100%"),""===e.style.margin&&(e.style.margin="10px auto"),""===e.style.display&&(e.style.display="block")}));B.current.querySelectorAll("*:not(script):not(style)").forEach((e=>{e.childNodes&&e.childNodes.length>0&&Array.from(e.childNodes).forEach((e=>{if(e.nodeType===Node.TEXT_NODE&&e.textContent){const o=e.textContent,r=/!\[(.*?)\]\((https?:\/\/[^)]+)\)/g;let i,n=0;const a=document.createDocumentFragment();let s=!1;for(;null!==(i=r.exec(o));){s=!0;const e=i.index,t=e+i[0].length;e>n&&a.appendChild(document.createTextNode(o.substring(n,e)));const r=document.createElement("img"),l=i[2];console.log(`(PostDetailPage useEffect) Processing Markdown image from text node: ${l.substring(0,50)}...`),r.setAttribute("data-original-src",l),r.src=(0,w.o6)(l),r.alt=i[1],r.className="markdown-image",r.style.maxWidth="100%",r.style.margin="10px auto",r.style.display="block",r.onerror=()=>((0,w.Mq)(l,r),!0),a.appendChild(r),n=t}var t;if(s)n<o.length&&a.appendChild(document.createTextNode(o.substring(n))),null===(t=e.parentNode)||void 0===t||t.replaceChild(a,e)}}))}))})()}return()=>{t&&t.disconnect()}}}),[null===J||void 0===J?void 0:J.content,w.o6]);const te=e=>{if(!e)return"";let t=e.replace(/!\[(.*?)\]\((https?:\/\/[^)]+)\)/g,((e,t,o)=>{if(!o)return e;console.log(`\u5904\u7406\u5e16\u5b50\u5185\u5bb9\u4e2d\u7684Markdown\u56fe\u7247 (processContentForVideos): alt=${t}, url=${o}`);return`<img src="${(0,w.o6)(o)}" data-original-src="${o}" alt="${t||"\u56fe\u7247"}" class="mx-auto my-4 max-w-full rounded-lg shadow-lg markdown-image" style="display: block; max-width: 100%; margin: 10px auto;" onerror="if(this.getAttribute('data-original-src')){window.handleImageLoadError?.(this.getAttribute('data-original-src'),this)}" />`}));return t=t.replace(/\[\u89c6\u9891\u5360\u4f4d\u7b26:\s*(https?:\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/watch\?v=)([a-zA-Z0-9_-]+))\]/g,((e,t,o)=>{if(!t||!o)return e;return`\n        <figure class="not-prose" style="all: initial; display: block; text-align: center; width: 100%; margin: 2em 0; font-family: inherit; color: inherit;">\n          <div style="width: 100%; max-width: 800px; margin: 0 auto; aspect-ratio: 16/9; background: #000; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); overflow: hidden; position: relative;">\n            <iframe src="${`https://www.youtube.com/embed/${o}`}" class="video-iframe" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 12px;" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen title="Embedded YouTube Video"></iframe>\n          </div>\n        </figure>\n      `})),t=t.replace(/\[\u89c6\u9891\u5360\u4f4d\u7b26:\s*(https?:\/\/(?:www\.)?bilibili\.com\/video\/([A-Za-z0-9]+)(?:\/)?.*?)\]/g,((e,t,o)=>{if(!t||!o)return e;return`\n        <figure class="not-prose" style="all: initial; display: block; text-align: center; width: 100%; margin: 2em 0; font-family: inherit; color: inherit;">\n          <div style="width: 100%; max-width: 800px; margin: 0 auto; aspect-ratio: 16/9; background: #000; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); overflow: hidden; position: relative;">\n            <iframe src="${`https://player.bilibili.com/player.html?bvid=${o}&page=1&high_quality=1&danmaku=0`}" class="video-iframe" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 12px;" frameborder="0" scrolling="no" allowfullscreen title="Embedded Bilibili Video"></iframe>\n          </div>\n        </figure>\n      `})),t};if(Z)return(0,x.jsx)(b,{});if(K||!J)return(0,x.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white p-4",style:{backgroundColor:"var(--bg-base-color)",backgroundImage:"var(--bg-gradient)"},children:[" ",(0,x.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"\u65e0\u6cd5\u52a0\u8f7d\u5e16\u5b50"}),(0,x.jsx)("p",{className:"text-gray-400 mb-8",children:ee||"\u5e16\u5b50\u53ef\u80fd\u5df2\u88ab\u5220\u9664\u6216\u94fe\u63a5\u65e0\u6548\u3002"}),(0,x.jsx)("button",{onClick:()=>T(-1),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-md text-white transition-colors",children:"\u8fd4\u56de"})]});const oe=te(J.content);return(0,x.jsxs)(c.P.div,{className:"post-detail-container pt-8 pb-16 px-2 md:px-4 lg:px-6 bg-transparent text-white min-h-screen",initial:{opacity:0},animate:{opacity:1},transition:{duration:.4,delay:.1},children:[(0,x.jsx)("div",{className:"max-w-4xl mx-auto transition-all duration-300 ease-in-out",children:(0,x.jsxs)(c.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"max-w-4xl mx-auto pb-8",children:[(0,x.jsxs)("header",{className:"mb-6 pb-4",children:[(0,x.jsx)("div",{className:"mb-3",children:(0,x.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-white break-words",children:J.title})}),(0,x.jsxs)("div",{className:"flex flex-wrap justify-between items-center text-sm text-gray-400 gap-x-4 gap-y-2",children:[(0,x.jsxs)("div",{className:"flex items-center flex-wrap gap-x-3 gap-y-1",children:[" ",(0,x.jsxs)("div",{className:"flex items-center relative",onMouseEnter:()=>{var e;null!==J&&void 0!==J&&J.author&&(W({nickname:J.author.nickname||(null===(e=J.author.email)||void 0===e?void 0:e.split("@")[0])||"\u533f\u540d\u7528\u6237",bio:J.author.bio,tags:J.author.tags,avatar:J.author.avatar}),U(!0))},onMouseLeave:()=>{U(!1)},children:[(0,x.jsx)("img",{src:(null===(e=J.author)||void 0===e?void 0:e.avatar)||`https://via.placeholder.com/40/374151/FFFFFF?text=${((null===(t=J.author)||void 0===t?void 0:t.nickname)||(null===(o=J.author)||void 0===o?void 0:o.email)||"U").charAt(0).toUpperCase()}`,alt:(null===(N=J.author)||void 0===N?void 0:N.nickname)||(null===(E=J.author)||void 0===E?void 0:E.email)||"\u4f5c\u8005\u5934\u50cf",className:"w-6 h-6 rounded-full mr-2 object-cover bg-gray-700"}),(0,x.jsx)(n.N_,{to:`/profile/${null===(k=J.author)||void 0===k?void 0:k.id}`,className:"text-blue-400 hover:text-blue-300 hover:underline",children:(re=J.author,re&&(re.nickname||re.email)||"\u533f\u540d\u7528\u6237")})]}),(0,x.jsx)("span",{className:"hidden sm:inline text-gray-500",children:"\u2022"}),(0,x.jsx)("span",{children:(e=>{if(!e)return"\u672a\u77e5\u65e5\u671f";try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}})(J.created_at)}),(0,x.jsx)("span",{className:"hidden sm:inline text-gray-500",children:"\u2022"}),(0,x.jsxs)("span",{children:["\u6d4f\u89c8\u91cf: ",J.view_count]})]}),(0,x.jsxs)("div",{className:"flex items-center space-x-4 flex-shrink-0",children:[J.tags&&J.tags.length>0&&(0,x.jsx)("div",{className:"flex flex-wrap gap-2",children:J.tags.map((e=>(0,x.jsx)("span",{className:"bg-indigo-600 text-white text-xs font-medium px-2.5 py-1 rounded-full",children:e},e)))}),P&&(0,x.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[(0,x.jsx)("button",{onClick:()=>T(`/edit-post/${J.slug}`),className:"px-3 py-1 text-xs font-medium text-gray-300 hover:text-white  bg-transparent border border-gray-500/70 hover:border-white/70  rounded-full transition-all duration-200  disabled:opacity-50 disabled:cursor-not-allowed",title:"\u7f16\u8f91\u5e16\u5b50",disabled:!(null!==J&&void 0!==J&&J.slug)||Z,children:"\u7f16\u8f91"}),(0,x.jsx)("button",{onClick:async()=>{if(!J||!C||!P)return void u.oR.error("\u65e0\u6cd5\u5220\u9664\u5e16\u5b50\uff1a\u6743\u9650\u4e0d\u8db3\u6216\u5e16\u5b50\u4fe1\u606f\u4e0d\u5b8c\u6574\u3002");const e=J.id,t=J.title;if(window.confirm(`\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5e16\u5b50 "${t||"\u6b64\u5e16\u5b50"}" \u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u9500\u3002`))try{const t=await s.A.delete(`${l.JR}/api/posts/${e}`,{headers:{Authorization:`Bearer ${C}`}});var o;if(200!==t.status&&204!==t.status)throw new Error((null===(o=t.data)||void 0===o?void 0:o.error)||"\u5220\u9664\u5e16\u5b50\u5931\u8d25");u.oR.success("\u5e16\u5b50\u5df2\u6210\u529f\u5220\u9664\uff01"),T("/community")}catch(n){var r,i;console.error(`\u5220\u9664\u5e16\u5b50 ${e} \u5931\u8d25:`,n);const t=(null===(r=n.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.error)||n.message||"\u5220\u9664\u5e16\u5b50\u65f6\u51fa\u9519";u.oR.error(`\u5220\u9664\u5931\u8d25: ${t}`)}},className:"px-3 py-1 text-xs font-medium text-gray-300 hover:text-white  bg-transparent border border-gray-500/70 hover:border-white/70  rounded-full transition-all duration-200  disabled:opacity-50 disabled:cursor-not-allowed",title:"\u5220\u9664\u5e16\u5b50",disabled:!(null!==J&&void 0!==J&&J.id)||Z,children:"\u5220\u9664"})]})]})]})]}),(0,x.jsx)("div",{ref:B,className:"prose prose-lg prose-invert max-w-none ck-content-output text-gray-300 prose-headings:font-semibold prose-headings:text-white prose-a:text-blue-400 prose-strong:text-white mt-6 prose-blockquote:border-l-blue-500 prose-blockquote:text-gray-400",dangerouslySetInnerHTML:{__html:oe||"<p>\u5185\u5bb9\u52a0\u8f7d\u5931\u8d25\u6216\u4e3a\u7a7a\u3002</p>"}}),(0,x.jsx)("div",{className:"mt-12 pt-8",children:(0,x.jsx)(a.A,{targetType:"post",targetId:J.id,apiBaseUrl:l.JR,token:C,currentUser:_,isLiked:J.is_liked||!1,isCollected:J.is_collected||!1,likeCount:J.likes_count||0,collectCount:J.collects_count||0,shareCount:A,handleLikeToggle:()=>{J&&_&&C&&!G.isPending&&$&&G.mutate({postId:J.id,token:C,currentLikeState:J.is_liked||!1,currentLikeActionId:J.like_action_id||null,postSlug:$})},handleCollectToggle:()=>{J&&_&&C&&!Q.isPending&&$&&Q.mutate({postId:J.id,token:C,currentCollectState:J.is_collected||!1,currentCollectActionId:J.collect_action_id||null,postSlug:$})},handleShareClick:()=>M(!0),isSubmittingAction:G.isPending||Q.isPending})})]})}),J&&(0,x.jsx)(f.A,{isOpen:L,onClose:()=>{M(!1),V(""),I(null)},onSubmit:async(e,t)=>{if(!J||!C)return u.oR.warn("\u8bf7\u5148\u767b\u5f55\u518d\u5206\u4eab"),void I("\u8bf7\u5148\u767b\u5f55\u518d\u5206\u4eab");O(!0),I(null);const o={action_type:"share",target_type:"post",target_id:J.id,content:e};try{const e=await s.A.post(`${l.JR}/api/actions`,o,{headers:{Authorization:`Bearer ${C}`}});if(201!==e.status&&200!==e.status){var r;const t=(null===(r=e.data)||void 0===r?void 0:r.error)||"\u5206\u4eab\u64cd\u4f5c\u5931\u8d25";throw I(t),new Error(t)}M(!1),V(""),S((e=>e+1)),u.oR.success("\u5206\u4eab\u6210\u529f\uff01"),X.invalidateQueries({queryKey:["postDetails",$]})}catch(a){var i,n;console.error("\u5206\u4eab\u64cd\u4f5c\u5931\u8d25:",a);const e=(null===(i=a.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.error)||a.message||"\u5206\u4eab\u64cd\u4f5c\u65f6\u51fa\u9519";I(e),u.oR.error(`\u5206\u4eab\u5931\u8d25: ${e}`)}finally{O(!1)}},comment:q,setComment:V,error:F,isLoading:R,dynamicToShare:J,username:(null===_||void 0===_?void 0:_.nickname)||"\u5f53\u524d\u7528\u6237",altText:`\u5206\u4eab\u5e16\u5b50: ${J.title}`}),z&&(0,x.jsx)(v.A,{nickname:z.nickname,bio:z.bio,tags:z.tags,avatar:z.avatar,isVisible:H})]});var re}}}]);
//# sourceMappingURL=783.c4e8938e.chunk.js.map