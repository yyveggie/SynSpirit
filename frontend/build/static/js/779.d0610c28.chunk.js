"use strict";(self.webpackChunkai_tools_website_frontend=self.webpackChunkai_tools_website_frontend||[]).push([[779],{2779:(e,t,l)=>{l.r(t),l.d(t,{default:()=>x});var s=l(5043),a=l(3216),n=l(6213),i=l(4558),r=l(6625),o=l(1745),d=l(6636),c=l(3248),u=l(579);const x=()=>{const{post_slug:e}=(0,a.g)(),t=(0,a.Zp)(),{token:l}=(0,r.A)(),x=(0,c.jE)(),[m,h]=(0,s.useState)(null),[g,p]=(0,s.useState)(""),[f,b]=(0,s.useState)(""),[v,y]=(0,s.useState)(!0),[j,N]=(0,s.useState)(!1),[w,$]=(0,s.useState)(null),[k,S]=(0,s.useState)(null),{isSidebarOpen:_}=(0,d.c)();(0,s.useRef)(null);(0,s.useEffect)((()=>{if(!l)return void t("/login",{state:{from:`/edit-post-toast/${e}`}});(async()=>{y(!0),$(null);try{const t=(await n.A.get(`${i.JR}/api/posts/slug/${e}`,{headers:{Authorization:`Bearer ${l}`}})).data;h(t),p(t.title),b(t.content)}catch(r){var t,s,a;console.error("Error fetching post for editing:",(null===(t=r.response)||void 0===t?void 0:t.data)||r.message),$((null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.error)||"\u65e0\u6cd5\u52a0\u8f7d\u5e16\u5b50\u6570\u636e\u8fdb\u884c\u7f16\u8f91")}finally{y(!1)}})()}),[e,l,t]);return v?(0,u.jsx)("div",{className:"flex flex-col min-h-screen bg-transparent text-gray-100",children:(0,u.jsx)("div",{className:"flex flex-1 pt-16 overflow-hidden",children:(0,u.jsx)("main",{className:"flex-1 p-6 transition-all duration-300 ease-in-out overflow-y-auto "+(_?"lg:ml-56":"ml-0"),children:(0,u.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,u.jsx)("p",{className:"text-xl",children:"\u6b63\u5728\u52a0\u8f7d\u5e16\u5b50..."})})})})}):w&&!m?(0,u.jsx)("div",{className:"flex flex-col min-h-screen bg-transparent text-gray-100",children:(0,u.jsx)("div",{className:"flex flex-1 pt-16 overflow-hidden",children:(0,u.jsx)("main",{className:"flex-1 p-6 transition-all duration-300 ease-in-out overflow-y-auto "+(_?"lg:ml-56":"ml-0"),children:(0,u.jsxs)("div",{className:"bg-red-700 text-white p-4 rounded shadow-lg text-center",children:[(0,u.jsx)("p",{className:"text-lg font-semibold",children:"\u51fa\u9519\u4e86"}),(0,u.jsx)("p",{children:w}),(0,u.jsx)("button",{onClick:()=>t(-1),className:"mt-3 bg-white text-red-700 px-4 py-2 rounded",children:"\u8fd4\u56de"})]})})})}):(0,u.jsx)("div",{className:"flex flex-col min-h-screen bg-transparent text-gray-100",children:(0,u.jsx)("div",{className:"flex flex-1 pt-16 overflow-hidden",children:(0,u.jsxs)("main",{className:"flex-1 p-6 transition-all duration-300 ease-in-out overflow-y-auto "+(_?"lg:ml-56":"ml-0"),children:[(0,u.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"\u7f16\u8f91\u5e16\u5b50"}),w&&(0,u.jsx)("div",{className:"bg-red-700 text-white p-3 rounded mb-4",children:w}),k&&(0,u.jsx)("div",{className:"bg-green-700 text-white p-3 rounded mb-4",children:k}),(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),m&&l){N(!0),$(null),S(null);try{const e={title:g,content:f},s=await n.A.put(`${i.JR}/api/posts/${m.id}`,e,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});S("\u5e16\u5b50\u66f4\u65b0\u6210\u529f!"),h(s.data),console.log(`[EditPostPageToast] \u4f7f\u5e16\u5b50\u7f13\u5b58\u5931\u6548: ${m.slug}`),x.invalidateQueries({queryKey:["postDetails",m.slug]}),setTimeout((()=>{m.community_slug?t(`/community/${m.community_slug}/post/${m.slug}`):t(`/posts/${m.slug}`)}),1500)}catch(o){var s,a,r;console.error("Error updating post:",(null===(s=o.response)||void 0===s?void 0:s.data)||o.message),$((null===(a=o.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.error)||"\u66f4\u65b0\u5e16\u5b50\u5931\u8d25")}finally{N(!1)}}},className:"bg-gray-850/70 p-6 rounded-lg shadow-xl border border-gray-700",children:[(0,u.jsxs)("div",{className:"mb-4",children:[(0,u.jsx)("label",{htmlFor:"title",className:"block text-gray-200 mb-2",children:"\u5e16\u5b50\u6807\u9898"}),(0,u.jsx)("input",{type:"text",id:"title",value:g,onChange:e=>p(e.target.value),required:!0,className:"w-full p-2 border border-gray-600 rounded bg-gray-700 text-gray-100 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"\u5e16\u5b50\u6807\u9898"})]}),(0,u.jsxs)("div",{className:"mb-6",children:[(0,u.jsx)("label",{className:"block text-gray-200 mb-2",children:"\u5e16\u5b50\u5185\u5bb9"}),(0,u.jsx)(o.A,{initialData:f,onChange:e=>{b(e)},token:l,placeholder:"\u8bf7\u8f93\u5165\u5e16\u5b50\u5185\u5bb9..."})]}),(0,u.jsx)("button",{type:"submit",disabled:j,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50",children:j?"\u6b63\u5728\u4fdd\u5b58...":"\u66f4\u65b0\u5e16\u5b50"})]})]})})})}}}]);
//# sourceMappingURL=779.d0610c28.chunk.js.map