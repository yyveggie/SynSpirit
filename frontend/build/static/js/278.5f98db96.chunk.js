"use strict";(self.webpackChunkai_tools_website_frontend=self.webpackChunkai_tools_website_frontend||[]).push([[278],{5278:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var a=r(5043),l=r(6625),s=r(3216),n=r(5475),i=r(579);const o=e=>{let{article:t}=e;return(0,i.jsx)("div",{className:"p-4 rounded-lg bg-gray-800/30 hover:bg-gray-800/50 transition-all duration-200",children:(0,i.jsxs)(n.N_,{to:`/article/${t.id}`,className:"flex items-start gap-4",children:[t.coverImage&&(0,i.jsx)("div",{className:"shrink-0 w-24 h-24 overflow-hidden rounded-md",children:(0,i.jsx)("img",{src:t.coverImage,alt:t.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="/images/fallback-cover.webp"}})}),(0,i.jsxs)("div",{className:"flex-grow",children:[(0,i.jsx)("h3",{className:"text-white text-lg font-medium mb-2 line-clamp-2",children:t.title}),(0,i.jsxs)("div",{className:"flex items-center text-sm text-gray-300 mt-3",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("img",{src:t.creator.avatar||"/images/default-avatar.png",alt:t.creator.username,className:"w-5 h-5 rounded-full mr-2",onError:e=>{e.target.src="/images/default-avatar.png"}}),(0,i.jsx)("span",{children:t.creator.username})]}),(0,i.jsx)("span",{className:"mx-2",children:"\xb7"}),(0,i.jsx)("span",{children:(e=>{const t=new Date,r=t.getTime()-e.getTime(),a=Math.floor(r/1e3/60),l=Math.floor(a/60),s=Math.floor(l/24);if(a<1)return"\u521a\u521a";if(a<60)return`${a}\u5206\u949f\u524d`;if(l<24)return`${l}\u5c0f\u65f6\u524d`;if(s<30)return`${s}\u5929\u524d`;const n=e.getFullYear(),i=e.getMonth()+1,o=e.getDate();return n===t.getFullYear()?`${i}\u6708${o}\u65e5`:`${n}\u5e74${i}\u6708${o}\u65e5`})(new Date(t.createdAt))})]})]})]})})},c=e=>{let{post:t}=e;return(0,i.jsx)("div",{className:"p-4 rounded-lg bg-gray-800/30 hover:bg-gray-800/50 transition-all duration-200",children:(0,i.jsxs)(n.N_,{to:`/posts/${t.id}`,className:"flex items-start gap-4",children:[t.coverImage&&(0,i.jsx)("div",{className:"shrink-0 w-24 h-24 overflow-hidden rounded-md",children:(0,i.jsx)("img",{src:t.coverImage,alt:t.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="/images/fallback-cover.webp"}})}),(0,i.jsxs)("div",{className:"flex-grow",children:[(0,i.jsx)("h3",{className:"text-white text-lg font-medium mb-2 line-clamp-2",children:t.title}),(0,i.jsxs)("div",{className:"flex items-center text-sm text-gray-300 mt-3",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("img",{src:t.creator.avatar||"/images/default-avatar.png",alt:t.creator.username,className:"w-5 h-5 rounded-full mr-2",onError:e=>{e.target.src="/images/default-avatar.png"}}),(0,i.jsx)("span",{children:t.creator.username})]}),(0,i.jsx)("span",{className:"mx-2",children:"\xb7"}),(0,i.jsx)("span",{children:(e=>{const t=new Date,r=t.getTime()-e.getTime(),a=Math.floor(r/1e3/60),l=Math.floor(a/60),s=Math.floor(l/24);if(a<1)return"\u521a\u521a";if(a<60)return`${a}\u5206\u949f\u524d`;if(l<24)return`${l}\u5c0f\u65f6\u524d`;if(s<30)return`${s}\u5929\u524d`;const n=e.getFullYear(),i=e.getMonth()+1,o=e.getDate();return n===t.getFullYear()?`${i}\u6708${o}\u65e5`:`${n}\u5e74${i}\u6708${o}\u65e5`})(new Date(t.createdAt))})]})]})]})})},d=e=>{let{dynamic:t}=e;return(0,i.jsx)("div",{className:"p-4 rounded-lg bg-gray-800/30 hover:bg-gray-800/50 transition-all duration-200",children:(0,i.jsxs)(n.N_,{to:`/dynamic/${t.id}`,className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)("img",{src:t.user.avatar||"/images/default-avatar.png",alt:t.user.username,className:"w-8 h-8 rounded-full mr-3",onError:e=>{e.target.src="/images/default-avatar.png"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-white font-medium",children:t.user.username}),(0,i.jsx)("div",{className:"text-xs text-gray-400",children:(e=>{const t=new Date,r=t.getTime()-e.getTime(),a=Math.floor(r/1e3/60),l=Math.floor(a/60),s=Math.floor(l/24);if(a<1)return"\u521a\u521a";if(a<60)return`${a}\u5206\u949f\u524d`;if(l<24)return`${l}\u5c0f\u65f6\u524d`;if(s<30)return`${s}\u5929\u524d`;const n=e.getFullYear(),i=e.getMonth()+1,o=e.getDate();return n===t.getFullYear()?`${i}\u6708${o}\u65e5`:`${n}\u5e74${i}\u6708${o}\u65e5`})(new Date(t.createdAt))})]})]}),(0,i.jsx)("div",{className:"text-gray-100 line-clamp-3",children:t.content}),t.images&&t.images.length>0&&(0,i.jsxs)("div",{className:"flex mt-2 gap-2 overflow-hidden",children:[t.images.slice(0,3).map(((e,t)=>(0,i.jsx)("div",{className:"w-20 h-20 rounded-md overflow-hidden flex-shrink-0",children:(0,i.jsx)("img",{src:e,alt:`\u52a8\u6001\u56fe\u7247 ${t+1}`,className:"w-full h-full object-cover",onError:e=>{e.target.src="/images/fallback-image.webp"}})},t))),t.images.length>3&&(0,i.jsx)("div",{className:"w-20 h-20 bg-gray-700/50 rounded-md flex items-center justify-center",children:(0,i.jsxs)("span",{className:"text-white",children:["+",t.images.length-3]})})]})]})})},m=()=>{const{token:e,user:t}=(0,l.A)(),r=(0,s.Zp)(),[n,m]=(0,a.useState)("all"),[g,u]=(0,a.useState)("all"),[x,p]=(0,a.useState)([]),[h,b]=(0,a.useState)(!0),[f,v]=(0,a.useState)({total:0,pages:0,page:1,per_page:10}),[j,N]=(0,a.useState)(null),y=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;b(!0);try{let l=`/api/users/me/interactions?page=${t}&per_page=${f.per_page}`;r&&"all"!==r&&(l+=`&content_type=${r}`),a&&"all"!==a&&(l+=`&interaction_type=${a}`);const s=await fetch(l,{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("\u83b7\u53d6\u6570\u636e\u5931\u8d25");const n=await s.json();200===n.code?(p(n.data.interactions),v(n.data.pagination)):N(n.message||"\u52a0\u8f7d\u5931\u8d25")}catch(l){N(l.message),console.error("\u83b7\u53d6\u4ea4\u4e92\u6570\u636e\u5931\u8d25:",l)}finally{b(!1)}};(0,a.useEffect)((()=>{if(e){y(1,"all"===n?null:n,"all"===g?null:g)}else r("/login")}),[e,n,g,r]);const w=e=>{if(e>=1&&e<=f.pages){y(e,"all"===n?null:n,"all"===g?null:g)}},$=e=>{m(e)},k=e=>{u(e)};return(0,i.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"\u6211\u7684\u7a7a\u95f4"}),(0,i.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,i.jsx)("button",{className:"px-4 py-2 rounded font-medium "+("all"===g?"bg-purple-600 hover:bg-purple-700 text-white":"bg-transparent hover:bg-blue-100/10 text-white border border-blue-400/30"),onClick:()=>k("all"),children:"\u5168\u90e8"}),(0,i.jsx)("button",{className:"px-4 py-2 rounded font-medium "+("like"===g?"bg-purple-600 hover:bg-purple-700 text-white":"bg-transparent hover:bg-blue-100/10 text-white border border-blue-400/30"),onClick:()=>k("like"),children:"\u6211\u7684\u70b9\u8d5e"}),(0,i.jsx)("button",{className:"px-4 py-2 rounded font-medium "+("collect"===g?"bg-purple-600 hover:bg-purple-700 text-white":"bg-transparent hover:bg-blue-100/10 text-white border border-blue-400/30"),onClick:()=>k("collect"),children:"\u6211\u7684\u6536\u85cf"})]}),(0,i.jsx)("div",{className:"border-b border-gray-200/20 mb-6",children:(0,i.jsxs)("div",{className:"-mb-px flex space-x-8",children:[(0,i.jsx)("button",{className:"py-2 px-1 font-medium text-sm border-b-2 "+("all"===n?"border-purple-500 text-purple-300":"border-transparent text-gray-300 hover:text-gray-100 hover:border-gray-300"),onClick:()=>$("all"),children:"\u5168\u90e8\u5185\u5bb9"}),(0,i.jsx)("button",{className:"py-2 px-1 font-medium text-sm border-b-2 "+("article"===n?"border-purple-500 text-purple-300":"border-transparent text-gray-300 hover:text-gray-100 hover:border-gray-300"),onClick:()=>$("article"),children:"\u6587\u7ae0"}),(0,i.jsx)("button",{className:"py-2 px-1 font-medium text-sm border-b-2 "+("post"===n?"border-purple-500 text-purple-300":"border-transparent text-gray-300 hover:text-gray-100 hover:border-gray-300"),onClick:()=>$("post"),children:"\u5e16\u5b50"}),(0,i.jsx)("button",{className:"py-2 px-1 font-medium text-sm border-b-2 "+("action"===n?"border-purple-500 text-purple-300":"border-transparent text-gray-300 hover:text-gray-100 hover:border-gray-300"),onClick:()=>$("action"),children:"\u52a8\u6001"})]})}),h?(0,i.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-white"})}):j?(0,i.jsxs)("div",{className:"text-center p-6 text-red-500",children:[(0,i.jsx)("p",{children:j}),(0,i.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:()=>{N(null),y(1,"all"===n?null:n,"all"===g?null:g)},children:"\u91cd\u8bd5"})]}):0===x.length?(0,i.jsx)("div",{className:"text-center p-10 text-gray-400",children:"\u6682\u65e0\u5185\u5bb9"}):(0,i.jsx)("div",{className:"grid gap-6 mt-6",children:x.map((e=>{if("article"===e.type)return(0,i.jsx)(o,{article:{id:e.content_id,title:e.title,coverImage:e.cover_image,creator:e.creator,createdAt:e.created_at}},`article-${e.id}`);if("post"===e.type)return(0,i.jsx)(c,{post:{id:e.content_id,title:e.title,coverImage:e.cover_image,creator:e.creator,createdAt:e.created_at}},`post-${e.id}`);if("action"===e.type){let t=[];return e.images&&(Array.isArray(e.images)?t=e.images:"string"===typeof e.images&&(t=e.images.trim()?e.images.split(","):[])),(0,i.jsx)(d,{dynamic:{id:e.content_id,content:e.content_preview||e.content,images:t,user:e.creator,createdAt:e.created_at}},`action-${e.id}`)}return null}))}),f.pages<=1?null:(0,i.jsx)("div",{className:"flex justify-center mt-8 mb-4",children:(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)("button",{className:"px-4 py-2 rounded border border-blue-400/30 text-white "+(1===f.page?"opacity-50 cursor-not-allowed":"hover:bg-blue-100/10"),disabled:1===f.page,onClick:()=>w(f.page-1),children:"\u4e0a\u4e00\u9875"}),(0,i.jsxs)("span",{className:"flex items-center px-4 bg-purple-100 text-purple-800 rounded",children:[f.page," / ",f.pages]}),(0,i.jsx)("button",{className:"px-4 py-2 rounded border border-blue-400/30 text-white "+(f.page===f.pages?"opacity-50 cursor-not-allowed":"hover:bg-blue-100/10"),disabled:f.page===f.pages,onClick:()=>w(f.page+1),children:"\u4e0b\u4e00\u9875"})]})})]})}}}]);
//# sourceMappingURL=278.5f98db96.chunk.js.map