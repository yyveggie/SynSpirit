/*! For license information please see 606.8b415ff7.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkai_tools_website_frontend=self.webpackChunkai_tools_website_frontend||[]).push([[606],{4606:(e,t,a)=>{a.r(t),a.d(t,{default:()=>M});var s=a(5043),r=a(3216),n=a(8775),i=a(2892),l=a(1795);var o=a(4383),c=a(6938),d=a(5475),u=a(6625),x=a(6636),h=a(6968),m=a(3248),p=a(8820),f=a(5550),y=(a(7950),a(7784));const v=(0,y.A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);var g=a(6213),b=a(4558);const w=g.A.create({baseURL:b.JR,withCredentials:!0,headers:{"Content-Type":"application/json"}});w.interceptors.request.use((e=>{const t=localStorage.getItem("token");return console.log("[\u901a\u77e5API] \u53d1\u9001\u8bf7\u6c42, token\u72b6\u6001:",t?"\u6709\u6548":"\u65e0\u6548"),t?e.headers.Authorization=`Bearer ${t}`:console.warn("[\u901a\u77e5API] \u6ca1\u6709\u627e\u5230\u6709\u6548\u7684\u6388\u6743token"),e}));const j=async()=>{try{return(await w.get("/api/notifications/unread-count")).data.unread_count}catch(e){return console.error("\u83b7\u53d6\u672a\u8bfb\u901a\u77e5\u6570\u91cf\u5931\u8d25:",e),0}};var k=a(6264),N=a(2377);const S=(0,y.A)("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var C=a(8899),_=a(579);const E=e=>{let{onClose:t,onUpdateUnreadCount:a}=e;const{user:n,token:i}=(0,u.A)(),l=(0,r.Zp)(),[o,c]=(0,s.useState)([]),[d,x]=(0,s.useState)(!0),[h,m]=(0,s.useState)(null),[p,f]=(0,s.useState)(1),[y,v]=(0,s.useState)(1),[g,b]=(0,s.useState)(!1),j=(0,s.useRef)(0),[E,P]=(0,s.useState)([]),A=(0,s.useMemo)((()=>g?E.filter((e=>!e.is_read)):E),[E,g]),I=()=>{const e=localStorage.getItem("token"),t=i;return console.log("[\u901a\u77e5] \u9a8c\u8bc1\u8ba4\u8bc1\u72b6\u6001:",{hasContextToken:!!t,hasLocalToken:!!e,hasUser:!!n}),!(!e&&!t)&&!!n},T=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(I()){e||x(!0),m(null);try{const e=localStorage.getItem("token");console.log("[\u901a\u77e5] \u5f00\u59cb\u83b7\u53d6\u901a\u77e5\u5217\u8868...",{"\u4f7f\u7528\u7684\u4ee4\u724c\u524d10\u4f4d":e?`${e.substring(0,10)}...`:"\u65e0","\u9875\u7801":p,"\u6bcf\u9875\u6570\u91cf":10,"\u4ec5\u672a\u8bfb":!1});const t=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{return(await w.get("/api/notifications",{params:{page:e,per_page:t,unread_only:a}})).data}catch(h){throw console.error("\u83b7\u53d6\u901a\u77e5\u5931\u8d25:",h),h}}(p,10,!1);console.log("[\u901a\u77e5] \u83b7\u53d6\u5230\u901a\u77e5\u5217\u8868:",t),P(t.notifications),v(t.pages),j.current=0;const s=t.notifications.filter((e=>!e.is_read)).length;a(s)}catch(h){var t,s,r,n,i;console.error("[\u901a\u77e5] \u83b7\u53d6\u901a\u77e5\u5931\u8d25",h),console.error("[\u901a\u77e5] \u9519\u8bef\u8be6\u60c5:",{"\u72b6\u6001\u7801":null===(t=h.response)||void 0===t?void 0:t.status,"\u9519\u8bef\u6d88\u606f":(null===(s=h.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.message)||h.message,"\u9519\u8bef\u7c7b\u578b":h.name,"\u8bf7\u6c42URL":null===(n=h.config)||void 0===n?void 0:n.url});const a=h&&(401===(null===(i=h.response)||void 0===i?void 0:i.status)||401===h.status);a?(m("\u8ba4\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),console.warn("[\u901a\u77e5] \u68c0\u6d4b\u5230\u8ba4\u8bc1\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u767b\u5f55\u72b6\u6001")):m("\u83b7\u53d6\u901a\u77e5\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),j.current<3&&!a&&(j.current+=1,console.log(`[\u901a\u77e5] \u5c06\u57282\u79d2\u540e\u8fdb\u884c\u7b2c${j.current}\u6b21\u91cd\u8bd5`),setTimeout((()=>T(!0)),2e3))}finally{e||x(!1)}}else m("\u672a\u767b\u5f55\u6216\u4f1a\u8bdd\u5df2\u8fc7\u671f")};(0,s.useEffect)((()=>{T()}),[p]);const L=async e=>{if(I())try{e.is_read||(await(async e=>{try{await w.put(`/api/notifications/${e}/read`,{})}catch(h){throw console.error("\u6807\u8bb0\u901a\u77e5\u5df2\u8bfb\u5931\u8d25:",h),h}})(e.id),P((t=>t.map((t=>t.id===e.id?{...t,is_read:!0}:t)))),a(E.filter((t=>!t.is_read&&t.id!==e.id)).length)),t(),e.related_url&&(e.related_url.includes("/profile/")?window.open(e.related_url,"_blank"):l(e.related_url))}catch(h){console.error("[\u901a\u77e5] \u6807\u8bb0\u901a\u77e5\u5df2\u8bfb\u5931\u8d25",h),e.related_url&&(t(),e.related_url.includes("/profile/")?window.open(e.related_url,"_blank"):l(e.related_url))}},U=e=>{try{const t=new Date(e);return(0,k.m)(t,{addSuffix:!0,locale:N.g})}catch(h){return console.error("[\u901a\u77e5] \u65f6\u95f4\u683c\u5f0f\u5316\u5931\u8d25",h),e}},z=e=>{e.currentTarget.src="https://via.placeholder.com/32x32?text=?"},M=e=>{b(e)};return(0,_.jsxs)("div",{className:"flex flex-col w-full",children:[(0,_.jsxs)("div",{className:"flex justify-between items-center py-2 px-3 border-b border-gray-200/50",children:[(0,_.jsxs)("div",{className:"flex space-x-2",children:[(0,_.jsx)("button",{className:"text-xs py-1 px-2 rounded text-black "+(g?"hover:bg-gray-100/70":"bg-gray-200/70 font-medium"),onClick:()=>M(!1),children:"\u5168\u90e8"}),(0,_.jsx)("button",{className:"text-xs py-1 px-2 rounded text-black "+(g?"bg-gray-200/70 font-medium":"hover:bg-gray-100/70"),onClick:()=>M(!0),children:"\u672a\u8bfb"})]}),(0,_.jsxs)("button",{className:"text-xs text-black py-1 px-2 rounded flex items-center space-x-1 hover:bg-gray-100/70",onClick:async()=>{if(I()&&0!==E.length&&!E.every((e=>e.is_read)))try{await(async()=>{try{await w.post("/api/notifications/mark-all-read",{})}catch(h){throw console.error("\u6807\u8bb0\u6240\u6709\u901a\u77e5\u5df2\u8bfb\u5931\u8d25:",h),h}})(),P((e=>e.map((e=>({...e,is_read:!0}))))),a(0)}catch(h){console.error("[\u901a\u77e5] \u6807\u8bb0\u5168\u90e8\u5df2\u8bfb\u5931\u8d25",h)}},disabled:0===E.length||E.every((e=>e.is_read)),children:[(0,_.jsx)(S,{className:"h-3 w-3"}),(0,_.jsx)("span",{children:"\u5168\u90e8\u5df2\u8bfb"})]})]}),(0,_.jsx)("div",{className:"max-h-80 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100",children:d?(0,_.jsx)("div",{className:"py-8 flex justify-center items-center",children:(0,_.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-gray-600"})}):h?(0,_.jsxs)("div",{className:"py-8 px-4 text-center",children:[(0,_.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:h}),(0,_.jsxs)("button",{className:"text-xs bg-gray-200 text-gray-700 py-1 px-3 rounded-full flex items-center mx-auto space-x-1 hover:bg-gray-300",onClick:()=>{m(null),T()},children:[(0,_.jsx)(C.A,{className:"h-3 w-3"}),(0,_.jsx)("span",{children:"\u91cd\u8bd5"})]})]}):0===A.length?(0,_.jsx)("div",{className:"py-12 px-4 text-center text-gray-600",children:(0,_.jsx)("p",{className:"text-sm",children:g?"\u6ca1\u6709\u672a\u8bfb\u901a\u77e5":"\u6682\u65e0\u901a\u77e5"})}):(0,_.jsx)("ul",{className:"divide-y divide-gray-200",children:A.map((e=>{var t;return(0,_.jsxs)("li",{className:"p-3 hover:bg-gray-100 cursor-pointer transition-colors duration-200 flex items-start space-x-3 "+(e.is_read?"":"bg-blue-50"),onClick:()=>L(e),children:[e.actor&&e.actor.avatar&&(0,_.jsx)("img",{src:e.actor.avatar,alt:e.actor.nickname||"\u7528\u6237\u5934\u50cf",className:"h-8 w-8 rounded-full object-cover flex-shrink-0",onError:z}),(0,_.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,_.jsxs)("div",{className:"flex items-start justify-between mb-1",children:[(0,_.jsx)("span",{className:"text-sm font-medium text-black truncate",children:(null===(t=e.actor)||void 0===t?void 0:t.nickname)||"\u7cfb\u7edf\u901a\u77e5"}),(0,_.jsx)("span",{className:"text-xs text-gray-500 ml-2 flex-shrink-0",children:U(e.created_at)})]}),(0,_.jsx)("p",{className:"text-xs text-gray-700 line-clamp-2",children:e.content}),!e.is_read&&(0,_.jsx)("div",{className:"mt-1 flex justify-end",children:(0,_.jsxs)("span",{className:"inline-flex items-center bg-green-100 text-green-700 rounded-full px-2 py-0.5 text-[10px]",children:[(0,_.jsx)("span",{className:"h-1.5 w-1.5 bg-green-500 rounded-full mr-1"}),"\u65b0\u6d88\u606f"]})})]})]},e.id)}))})}),!d&&!h&&y>1&&(0,_.jsxs)("div",{className:"flex justify-between items-center px-3 py-2 border-t border-gray-200",children:[(0,_.jsx)("button",{className:"text-xs text-gray-600 hover:text-black disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>f((e=>Math.max(1,e-1))),disabled:1===p,children:"\u4e0a\u4e00\u9875"}),(0,_.jsxs)("span",{className:"text-xs text-gray-600",children:[p," / ",y]}),(0,_.jsx)("button",{className:"text-xs text-gray-600 hover:text-black disabled:text-gray-400 disabled:cursor-not-allowed",onClick:()=>f((e=>Math.min(y,e+1))),disabled:p===y,children:"\u4e0b\u4e00\u9875"})]})]})},P=()=>{const{user:e,token:t}=(0,u.A)(),[a,r]=(0,s.useState)(0),[n,i]=(0,s.useState)(!1),[l,d]=(0,s.useState)(!1),[x,h]=(0,s.useState)(0),[m,p]=(0,s.useState)(!0),f=(0,s.useRef)(null),y=(0,s.useRef)(!1),g=(0,s.useRef)(null),b=()=>!!(t&&e&&localStorage.getItem("token"));(0,s.useEffect)((()=>{const e=async()=>{if(b()&&!y.current){y.current=!0;try{console.log("[\u901a\u77e5] \u5f00\u59cb\u83b7\u53d6\u672a\u8bfb\u901a\u77e5\u6570\u91cf...");const e=await j();console.log(`[\u901a\u77e5] \u83b7\u53d6\u5230\u672a\u8bfb\u901a\u77e5\u6570\u91cf: ${e}`),r(e),d(!1),h(0),p(!0)}catch(a){var t;console.error("[\u901a\u77e5] \u83b7\u53d6\u672a\u8bfb\u901a\u77e5\u6570\u91cf\u5931\u8d25",a);if(a&&(401===(null===(t=a.response)||void 0===t?void 0:t.status)||401===a.status))return console.log("[\u901a\u77e5] \u8ba4\u8bc1\u9519\u8bef\uff0c\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u767b\u5f55"),void p(!1);d(!0),h((e=>e+1)),x>=3&&(console.log("[\u901a\u77e5] \u8fde\u7eed\u9519\u8bef\u8d85\u8fc73\u6b21\uff0c\u6682\u65f6\u9690\u85cf\u901a\u77e5\u56fe\u6807"),p(!1),f.current&&clearTimeout(f.current),f.current=setTimeout((()=>{console.log("[\u901a\u77e5] \u5c1d\u8bd5\u6062\u590d\u663e\u793a\u901a\u77e5\u56fe\u6807"),p(!0),h(0),e()}),3e4))}finally{y.current=!1}}};b()&&e();const t=setInterval((()=>{b()&&e()}),6e4);return()=>{clearInterval(t),f.current&&clearTimeout(f.current)}}),[e,t,x]),(0,s.useEffect)((()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&i(!1)};return n&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[n]);return b()&&m?(0,_.jsxs)("div",{className:"relative",ref:g,children:[(0,_.jsxs)(o.P.button,{onClick:()=>{if(l)return d(!1),void(!y.current&&b()&&j().then((e=>{r(e),i(!0)})).catch((e=>{console.error("[\u901a\u77e5] \u91cd\u8bd5\u83b7\u53d6\u672a\u8bfb\u901a\u77e5\u6570\u91cf\u5931\u8d25",e),d(!0)})));i(!n)},className:"z-50 flex items-center justify-center w-8 h-8 rounded-full transition-all duration-300 hover:bg-white/10 "+(l?"opacity-50":""),whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":l?"\u901a\u77e5\u52a0\u8f7d\u5931\u8d25\uff0c\u70b9\u51fb\u91cd\u8bd5":"\u901a\u77e5",children:[(0,_.jsx)(v,{className:"h-5 w-5 text-black",strokeWidth:2}),!l&&a>0&&(0,_.jsx)("span",{className:"absolute top-0 right-0 h-4 w-4 flex items-center justify-center text-[9px] text-white bg-red-500 rounded-full",children:a>99?"99+":a})]}),(0,_.jsx)(c.N,{children:n&&!l&&(0,_.jsx)(o.P.div,{className:"absolute right-0 top-full mt-1 w-80 z-50 flex flex-col items-start",initial:{opacity:0,y:-5,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-5,scale:.95},transition:{duration:.15,ease:[.4,0,.2,1]},children:(0,_.jsx)(o.P.div,{className:"w-full bg-white border border-gray-200 shadow-xl rounded-lg overflow-hidden",variants:{hidden:{opacity:0,y:-10},show:{opacity:1,y:0}},children:(0,_.jsx)("div",{className:"p-2",children:(0,_.jsx)(E,{onClose:()=>i(!1),onUpdateUnreadCount:e=>{r(e)}})})})})})]}):null},A=e=>{let{to:t,children:a,title:s}=e;const n=(0,r.zy)();return(0,_.jsx)(d.N_,{to:t,onClick:(l=t,e=>{e.preventDefault();const t=`/preload.html?redirect=${encodeURIComponent(l)}`,a=window.open(t,"_blank");a&&(a.opener=null)}),title:s||String(a),className:"flex items-center px-2 py-1.5 text-sm font-medium rounded-md transition-all duration-200 ease-[cubic-bezier(0.4,0,0.2,1)] "+(i=t,("/"===i?"/"===n.pathname:n.pathname.startsWith(i))?"text-black bg-gradient-to-r from-green-200/30 to-blue-200/30 opacity-100 shadow-inner":"text-black hover:bg-gradient-to-r hover:from-green-200/10 hover:to-blue-200/10 hover:opacity-90 hover:shadow-sm"),children:a});var i,l},I=e=>{let{className:t}=e;const{token:a,user:n,logout:i,isLoading:l}=(0,u.A)(),{toggleSidebar:d}=(0,x.c)(),y=(0,r.Zp)(),v=((0,r.zy)(),(0,m.jE)()),{openInNewTab:g,toggleOpenInNewTab:b}=(0,f.ix)(),w=(0,s.useRef)(null),j=(0,s.useRef)(null),{data:k=[],isLoading:N}=(0,h.Q)(a),S=(0,s.useCallback)((()=>{v.invalidateQueries({queryKey:["userFavorites"]})}),[v]);(0,s.useEffect)((()=>(window.addEventListener("favoritesUpdated",S),()=>{window.removeEventListener("favoritesUpdated",S)})),[S]);const[C,E]=(0,s.useState)(!1),[I,T]=(0,s.useState)(!1),[L,U]=(0,s.useState)(!1),[z,M]=(0,s.useState)(!1),[R,$]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=e=>{w.current&&!w.current.contains(e.target)&&M(!1),j.current&&!j.current.contains(e.target)&&$(!1)};return(z||R)&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[z,R]);return l?null:(0,_.jsx)("nav",{className:`py-4 z-40 bg-transparent ${t||""}`,children:(0,_.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,_.jsxs)("div",{className:"flex justify-between items-center",children:[(0,_.jsx)("div",{className:"flex items-center",children:(0,_.jsx)(p.A,{to:"/",forceSameTab:!0,className:"flex items-center text-xl font-serif font-semibold text-black hover:text-gray-700 transition-colors duration-200",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", Helvetica, Arial, sans-serif'},children:"SynSpirit"})}),(0,_.jsxs)("div",{className:"hidden md:flex items-center space-x-6",children:[(0,_.jsx)(A,{to:"/articles",title:"\u6587\u7ae0",children:"\u6587\u7ae0"}),(0,_.jsx)(A,{to:"/tools",title:"\u5de5\u5177",children:"\u5de5\u5177"}),n&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A,{to:"/community",title:"\u793e\u533a",children:"\u793e\u533a"}),(0,_.jsx)(A,{to:"/space",title:"\u7a7a\u95f4",children:"\u7a7a\u95f4"})]})]}),(0,_.jsx)("div",{className:"flex space-x-8 items-center",children:(0,_.jsx)("div",{className:"flex items-center space-x-4",children:a?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"relative",ref:w,children:[(0,_.jsx)(o.P.button,{onClick:()=>M(!z),className:"z-50 flex items-center justify-center w-8 h-8 rounded-full transition-all duration-300 hover:bg-white/10",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"\u521b\u5efa\u65b0\u5185\u5bb9",children:(0,_.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",children:[(0,_.jsx)("path",{d:"M12 4V20",stroke:"black",strokeWidth:"2.2",strokeLinecap:"round"}),(0,_.jsx)("path",{d:"M4 12H20",stroke:"black",strokeWidth:"2.2",strokeLinecap:"round"})]})}),(0,_.jsx)(c.N,{children:z&&(0,_.jsx)(o.P.div,{className:"absolute right-0 top-full mt-1 w-28 z-50 flex flex-col items-start",initial:{opacity:0,y:-5,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-5,scale:.95},transition:{duration:.15,ease:[.4,0,.2,1]},children:(0,_.jsxs)(o.P.div,{className:"w-full bg-white border border-gray-200 shadow-xl rounded-lg overflow-hidden",variants:{hidden:{opacity:0},show:{opacity:1}},children:[(0,_.jsx)(o.P.div,{initial:{x:-5,opacity:0},animate:{x:0,opacity:1},transition:{delay:.05,duration:.12},className:"w-full",children:(0,_.jsx)(p.A,{to:"/new-article",className:"block px-3 py-1.5 text-xs text-black font-medium hover:bg-gray-100 transition-colors duration-150 w-full text-left",onClick:()=>M(!1),children:"\u5199\u6587\u7ae0"})}),(0,_.jsx)(o.P.div,{initial:{x:-5,opacity:0},animate:{x:0,opacity:1},transition:{delay:.08,duration:.12},className:"w-full",children:(0,_.jsx)("button",{className:"block px-3 py-1.5 text-xs text-black font-medium hover:bg-gray-100 transition-colors duration-150 w-full text-left",onClick:e=>{e.preventDefault(),M(!1);const t=new CustomEvent("openCreateDynamicModal");window.dispatchEvent(t)},children:"\u53d1\u52a8\u6001"})})]})})})]}),(0,_.jsx)("div",{className:"relative hidden md:block",children:(0,_.jsx)(P,{},`notification-${(null===n||void 0===n?void 0:n.id)||"guest"}`)}),(0,_.jsxs)("div",{className:"relative",ref:j,children:[(0,_.jsx)("button",{onClick:()=>$(!R),className:"border border-gray-600 rounded-full overflow-hidden hover:border-gray-400 transition-colors duration-200 flex items-center justify-center w-8 h-8",children:n&&n.avatar?(0,_.jsx)("img",{src:n.avatar,alt:n.nickname||n.email||"User avatar",className:"h-full w-full object-cover",onError:e=>{e.currentTarget.src="https://synspirit-test-131313901.cos.ap-shanghai.myqcloud.com/system/default_avatar.png"}}):(0,_.jsx)("span",{className:"text-white text-xs",children:n&&n.nickname?n.nickname.charAt(0).toUpperCase():n&&n.email?n.email.charAt(0).toUpperCase():"U"})}),(0,_.jsx)(c.N,{children:R&&(0,_.jsx)(o.P.div,{className:"absolute right-0 top-full mt-1 w-28 z-50 flex flex-col items-start",initial:{opacity:0,y:-5,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-5,scale:.95},transition:{duration:.15,ease:[.4,0,.2,1]},children:(0,_.jsxs)(o.P.div,{className:"w-full bg-white border border-gray-200 shadow-xl rounded-lg overflow-hidden",variants:{hidden:{opacity:0},show:{opacity:1}},children:[(0,_.jsx)(o.P.div,{initial:{x:-5,opacity:0},animate:{x:0,opacity:1},transition:{delay:.05,duration:.12},className:"w-full",children:(0,_.jsx)("button",{onClick:e=>{if(e.preventDefault(),e.stopPropagation(),$(!1),a&&n){const e=`/profile/me?t=${Date.now()}`,t=document.createElement("a");t.href=e,t.target="_blank",t.rel="noopener noreferrer",document.body.appendChild(t),t.click(),setTimeout((()=>{document.body.removeChild(t)}),0)}else y("/login",{state:{from:"/profile/me"}})},className:"block px-3 py-1.5 text-xs text-black font-medium hover:bg-gray-100 transition-colors duration-150 w-full text-left",children:"\u4e2a\u4eba\u4e3b\u9875"})}),(0,_.jsx)(o.P.div,{initial:{x:-5,opacity:0},animate:{x:0,opacity:1},transition:{delay:.08,duration:.12},className:"w-full",children:(0,_.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),$(!1),i(),y("/login")},className:"block px-3 py-1.5 text-xs text-black font-medium hover:bg-gray-100 transition-colors duration-150 w-full text-left",children:"\u9000\u51fa\u767b\u5f55"})})]})})})]})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(p.A,{to:"/login",className:"text-gray-300 hover:text-white transition-colors duration-200 text-sm",children:"\u767b\u5f55"}),(0,_.jsx)(p.A,{to:"/register",className:"bg-gradient-to-r from-green-400 to-blue-500 hover:from-green-500 hover:to-blue-600 text-white px-4 py-1.5 rounded-full text-sm transition-all duration-300 shadow hover:shadow-lg",children:"\u6ce8\u518c"})]})})})]})})})},T=(0,s.lazy)((()=>Promise.all([a.e(778),a.e(535)]).then(a.bind(a,4535)))),L={open:{x:"-70%",transition:{type:"tween",ease:"easeInOut",duration:.3}},closed:{x:"0%",transition:{type:"tween",ease:"easeInOut",duration:.3}}},U={hidden:{x:"100%",opacity:.3},visible:{x:0,opacity:1,transition:{type:"tween",ease:"easeInOut",duration:.3,when:"beforeChildren",staggerChildren:.05}},exit:{x:"100%",opacity:0,transition:{type:"tween",ease:"easeInOut",duration:.3}}},z={hidden:{opacity:0,x:10},visible:{opacity:1,x:0,transition:{type:"tween",ease:"easeInOut",duration:.3}}},M=()=>{const{isTimelineOpen:e,closeTimeline:t}=(0,n.x)(),[a,d]=(function(){!l.r.current&&(0,i.U)();const[e]=(0,s.useState)(l.O.current)}(),(0,s.useState)(!1)),[u,x]=(0,s.useState)(0);return(0,s.useEffect)((()=>{d(!0);const e=()=>{const e=document.querySelector("nav");if(e){const t=e.offsetHeight;t!==u&&t>0&&(x(t),document.documentElement.style.setProperty("--navbar-height",`${t}px`))}};e();const t=new ResizeObserver(e),a=document.querySelector("nav");a&&t.observe(a);const s=setTimeout(e,100);return()=>{a&&t.unobserve(a),t.disconnect(),clearTimeout(s),document.documentElement.style.removeProperty("--navbar-height")}}),[u]),(0,s.useEffect)((()=>{}),[e]),(0,s.useEffect)((()=>{if(!e&&a&&window.location.pathname.startsWith("/dynamic/")){const e=sessionStorage.getItem("previousUrl")||"/";console.log("[MainLayout] \u68c0\u6d4b\u5230\u65f6\u95f4\u680f\u5173\u95ed\uff0c\u5f3a\u5236\u6062\u590dURL\u5230:",e),sessionStorage.removeItem("previousUrl"),window.history.replaceState(null,"",e)}}),[e,a]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"fixed inset-0 w-full h-full overflow-hidden",style:{background:"#ffffff",zIndex:-10,opacity:1}}),(0,_.jsx)(I,{className:"relative z-50"}),(0,_.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 w-full min-h-screen overflow-visible",children:[(0,_.jsx)(o.P.div,{className:"w-full",animate:e&&a?"open":"closed",initial:!1,variants:L,style:{willChange:"transform",position:"static",zIndex:1},children:(0,_.jsx)(r.sv,{})}),(0,_.jsx)(c.N,{children:e&&a&&(0,_.jsx)(o.P.div,{className:"fixed right-0 z-40 overflow-y-auto flex justify-center items-start",style:{width:"70%",willChange:"transform, opacity",pointerEvents:"auto",touchAction:"pan-y",WebkitOverflowScrolling:"touch",top:`${u}px`,height:`calc(100vh - ${u}px)`},initial:"hidden",animate:"visible",exit:"exit",variants:U,children:(0,_.jsx)(o.P.div,{variants:z,children:(0,_.jsx)(s.Suspense,{fallback:(0,_.jsx)("div",{className:"text-center text-white/50 mt-10",children:"\u52a0\u8f7d\u4e2d..."}),children:(0,_.jsx)(T,{})})})})})]})]})}},8899:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(7784).A)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])}}]);
//# sourceMappingURL=606.8b415ff7.chunk.js.map