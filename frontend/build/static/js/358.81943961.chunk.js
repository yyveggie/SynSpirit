"use strict";(self.webpackChunkai_tools_website_frontend=self.webpackChunkai_tools_website_frontend||[]).push([[358],{2358:(e,t,n)=>{n.d(t,{A:()=>x});var o=n(5043),r=n(3216),s=n(579);const i=e=>{let{name:t,description:n,slug:o,id:i,isFavorited:a,onToggleFavorite:l,isLoadingFavorite:c,onCreatePost:d}=e;(0,r.Zp)();return(0,s.jsxs)("div",{className:"rounded-lg bg-gray-800/50 p-4 shadow-md backdrop-blur-sm border border-gray-700/50",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:t}),(0,s.jsx)("p",{className:"text-sm text-gray-300 mb-4",children:n||"\u6682\u65e0\u793e\u533a\u63cf\u8ff0\u3002"})]})},a=e=>{let{post:t,parentType:n,parentSlug:r}=e;const i=t.content||t.summary||t.excerpt||"",a=void 0!==t.likes_count?t.likes_count:t.like_count,l=void 0!==t.collects_count?t.collects_count:t.collect_count,c=void 0!==t.comments_count?t.comments_count:void 0!==t.comment_count?t.comment_count:t.comments,d=void 0!==t.shares_count?t.shares_count:t.share_count,m=(0,o.useCallback)((e=>t=>{t.preventDefault();const n=`/preload.html?redirect=${encodeURIComponent(e)}`,o=window.open(n,"_blank");o&&(o.opener=null)}),[]),u=(()=>{const e=t.slug||t.id;if(r&&e){return`/community/${"topic"===n?"topic":"relationship-topic"}/${r}/posts/${e}`}return console.warn(`[FrostedPostCard] Missing parentSlug (${r}) or post identifier (${e}) for post ID ${t.id}. Falling back to old URL.`),`/posts/${e}`})();return(0,s.jsx)("div",{className:"rounded-lg overflow-hidden  bg-gray-900/50 backdrop-blur-lg  shadow-lg hover:shadow-xl  transform transition-all duration-300 hover:scale-[1.02] hover:-translate-y-1 flex flex-col",children:(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsxs)("a",{href:u,onClick:m(u),className:"hover:text-blue-300 transition-colors mb-2 block cursor-pointer",title:t.title,children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white line-clamp-1",children:t.title})," "]}),i&&(0,s.jsxs)("div",{className:"text-gray-300 text-sm my-4 post-content-container",children:[(0,s.jsx)("style",{children:"\n              .post-content-container img, \n              .post-content-container video,\n              .post-content-container iframe,\n              .post-content-container figure {\n                margin-left: auto;\n                margin-right: auto;\n                display: block;\n                max-width: 100%;\n              }\n              .post-content-container .post-content p {\n                margin-bottom: 1rem;\n              }\n              .post-content-container a {\n                color: #60a5fa;\n                text-decoration: none;\n              }\n              .post-content-container a:hover {\n                text-decoration: underline;\n              }\n            "}),(0,s.jsx)("div",{className:"post-content",dangerouslySetInnerHTML:{__html:i.replace(/!\[(.*?)\]\((https?:\/\/[^)]+)\)/g,'<img src="$2" alt="$1" style="max-width:100%; display:block; margin:0 auto;">').replace(/\[\u89c6\u9891\u5360\u4f4d\u7b26:\s*(https?:\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/watch\?v=)([a-zA-Z0-9_-]+))\]/g,((e,t,n)=>`\n                    <figure class="not-prose video-figure" style="all: initial; display: block; text-align: center; width: 100%; margin: 1.5em 0; font-family: inherit; color: inherit;">\n                      <div class="video-wrapper" style="width: 100%; max-width: 720px; margin: 0 auto; aspect-ratio: 16/9; background: #000; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); overflow: hidden; position: relative;">\n                        <iframe src="https://www.youtube.com/embed/${n}?autoplay=0&mute=0&controls=1" class="video-iframe" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 8px;" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen title="Embedded YouTube Video"></iframe>\n                      </div>\n                    </figure>\n                  `)).replace(/\[\u89c6\u9891\u5360\u4f4d\u7b26:\s*(https?:\/\/(?:www\.)?bilibili\.com\/video\/([A-Za-z0-9]+)(?:\/)?.*?)\]/g,((e,t,n)=>`\n                    <figure class="not-prose video-figure" style="all: initial; display: block; text-align: center; width: 100%; margin: 1.5em 0; font-family: inherit; color: inherit;">\n                      <div class="video-wrapper" style="width: 100%; max-width: 720px; margin: 0 auto; aspect-ratio: 16/9; background: #000; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); overflow: hidden; position: relative;">\n                        <iframe src="https://player.bilibili.com/player.html?bvid=${n}&page=1&high_quality=1&danmaku=0&autoplay=0" class="video-iframe" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 8px;" frameborder="0" scrolling="no" allowfullscreen title="Embedded Bilibili Video"></iframe>\n                      </div>\n                    </figure>\n                  `))}})]}),(0,s.jsxs)("div",{className:"flex justify-between items-end mt-4",children:[(0,s.jsxs)("div",{className:"flex gap-3 text-xs text-gray-400",children:[void 0!==a&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,s.jsx)("span",{children:a||0})]}),void 0!==c&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,s.jsx)("span",{children:c||0})]}),void 0!==l&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),(0,s.jsx)("span",{children:l||0})]}),void 0!==d&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),(0,s.jsx)("span",{children:d||0})]})]}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:(0,s.jsxs)("span",{children:["\u7531 ",t.author?"string"===typeof t.author?t.author:t.author.nickname?t.author.nickname:t.author.email?t.author.email:"\u533f\u540d":"\u533f\u540d"," \u53d1\u5e03\u4e8e ",(e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime()))return e;const n=t.getFullYear(),o=t.getMonth()+1,r=t.getDate(),s=t.getHours().toString().padStart(2,"0");return`${n}/${o}/${r} ${s}:${t.getMinutes().toString().padStart(2,"0")}`}catch(t){return e}})(t.created_at||t.timestamp)]})})]})]})})};var l=n(6636),c=n(5475),d=n(2104),m=n(2115),u=n(4558),h=n(6625);const g=e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime()))return console.error(`[Chat Timestamp] \u89e3\u6790\u65f6\u95f4\u6233\u5931\u8d25\uff0c\u683c\u5f0f\u65e0\u6548: ${e}`),e;const n=new Date,o=new Date(n.toLocaleString("en-US",{timeZone:"Asia/Shanghai"})),r=new Date(t.toLocaleString("en-US",{timeZone:"Asia/Shanghai"})),s=new Date(o.getFullYear(),o.getMonth(),o.getDate()),i=new Date(s);i.setDate(s.getDate()-1);const a={timeZone:"Asia/Shanghai",hour:"2-digit",minute:"2-digit",hour12:!1},l=t.toLocaleTimeString("zh-CN",a);if(r>=s)return l;if(r>=i)return`\u6628\u5929 ${l}`;{const e=r.getFullYear(),t=(r.getMonth()+1).toString().padStart(2,"0");return`${e}/${t}/${r.getDate().toString().padStart(2,"0")} ${l}`}}catch(t){return console.error("[Chat Timestamp] \u683c\u5f0f\u5316\u804a\u5929\u65f6\u95f4\u6233\u65f6\u6355\u83b7\u5230\u5f02\u5e38:",t),e}},p=e=>{let{communityId:t,communityType:n,communityName:r,isOpen:i,onClose:a}=e;const{user:l,token:p}=(0,h.A)(),[x,f]=(0,o.useState)(null),v=(0,o.useRef)(null),[y,w]=(0,o.useState)([]),[b,j]=(0,o.useState)(""),[k,N]=(0,o.useState)(!1),C=(0,o.useRef)(null),[_,S]=(0,o.useState)(!1),[$,P]=(0,o.useState)(!1),[D,L]=(0,o.useState)(!0),[M,T]=(0,o.useState)(0),[I,E]=(0,o.useState)(!1),[R,F]=(0,o.useState)(!1),[z,A]=(0,o.useState)(!1),[B,O]=(0,o.useState)(!1),H=(0,o.useRef)(new Set),q=(0,o.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";C.current&&C.current.scrollTo({top:C.current.scrollHeight,behavior:e})}),[]);(0,o.useEffect)((()=>{if(i){const e=setTimeout((()=>{F(!0)}),300);return()=>clearTimeout(e)}F(!1)}),[i]),(0,o.useEffect)((()=>{let e=!0,o=null;const r=()=>{v.current&&(console.log(`[ChatPanel Disconnect] Disconnecting socket for ${n} ID: ${t}`),v.current.off("connect"),v.current.off("message_history"),v.current.off("receive_message"),v.current.off("status"),v.current.off("error"),v.current.off("disconnect"),v.current.off("connect_error"),v.current.disconnect(),v.current=null),f(null),S(!1),N(!1),H.current.clear()};return i?(console.log("[ChatPanel Effect] isOpen is true, attempting to connect."),(()=>{if(!t||!p)return void console.log(`[ChatPanel Connect] Pre-check failed (communityId: ${t}, token: ${!!p})`);v.current&&(console.log("[ChatPanel Connect] Disconnecting existing socket before new connection."),v.current.disconnect(),v.current=null,f(null),N(!1),S(!1),w([]));const r="topic"===n?`community_topic_${t}`:`community_relationship_topic_${t}`;console.log(`[ChatPanel Socket] Attempting to connect and join room: ${r} (ID: ${t})`),w([]),S(!1),N(!1),P(!1),L(!0),T(0),E(!1),A(!1),H.current.clear(),o=(0,d.io)((0,u.Kp)(),{path:"/socket.io",transports:["websocket","polling"],auth:{token:p},reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,timeout:1e4}),v.current=o,f(o),o.on("connect",(()=>{var t,n,s;e&&v.current===o&&(console.log(`[ChatPanel Socket] \u8fde\u63a5\u6210\u529f! SID: ${null===(t=o)||void 0===t?void 0:t.id}`),N(!0),null===(n=o)||void 0===n||n.emit("join",{room:r,username:(null===l||void 0===l?void 0:l.nickname)||"Anonymous"}),console.log(`[ChatPanel Socket] Emitting initial request_history for room: ${r} with limit 30`),null===(s=o)||void 0===s||s.emit("request_history",{room:r,limit:30}))})),o.on("message_history",(t=>{if(!e||v.current!==o)return;const{history:n,has_more:r,requested_before_id:s}=t;if(console.log(`[ChatPanel Socket] Received message_history (${n.length} messages). Has more: ${r}. Requested before ID: ${s}`),L(r),s){P(!0);const e=C.current,t=(null===e||void 0===e?void 0:e.scrollHeight)||0,o=(null===e||void 0===e?void 0:e.scrollTop)||0;n.forEach((e=>H.current.add(e.id))),w((e=>{const t=new Set(e.map((e=>e.id)));return[...n.filter((e=>!t.has(e.id))),...e]})),requestAnimationFrame((()=>{if(e){const n=e.scrollHeight;e.scrollTop=n-t+o,console.log(`[ChatPanel Scroll] Restored scroll after loading older history. OldTop: ${o}, OldHeight: ${t}, NewHeight: ${n}, NewTop: ${e.scrollTop}`)}})),P(!1)}else{if(A(!0),0===n.length)return console.log("[ChatPanel Socket] Initial history is empty."),w([]),void S(!0);n.forEach((e=>H.current.add(e.id))),w(n),T(100),setTimeout((()=>{S(!0),q("auto")}),100)}})),o.on("receive_message",(t=>{if(!e||v.current!==o)return;if(console.log("[ChatPanel Socket] Received new message object:",t),console.log("[ChatPanel Socket] Message local_id from server:",t.local_id),H.current.has(t.id))return void console.log(`[ChatPanel Socket] Skipping already processed message: ${t.id}`);H.current.add(t.id);const n=t.userId===(null===l||void 0===l?void 0:l.id)&&!t.is_system_message;console.log(`[ChatPanel Receive] Processing message ID: ${t.id}, Local ID: ${t.local_id}`),console.log(`[ChatPanel Receive] Is own message? ${n} (User ID: ${null===l||void 0===l?void 0:l.id}, Message UserID: ${t.userId})`),w((e=>{if(n&&t.local_id){const n=e.findIndex((e=>e.id===t.local_id));if(n>-1){const o=[...e];return o[n]={...t,id:t.id},o}return e.some((e=>e.id===t.id))?e:[...e,t]}return e.some((e=>e.id===t.id))?e:[...e,t]})),setTimeout((()=>q("smooth")),100)})),o.on("status",(t=>{e&&v.current===o&&console.log("[ChatPanel Socket] Status:",t.msg)})),o.on("error",(t=>{e&&v.current===o&&(console.error("[ChatPanel Socket] Error:",t.message),m.oR.error(`\u804a\u5929\u9519\u8bef: ${t.message}`))})),o.on("disconnect",(e=>{v.current===o&&(console.log(`[ChatPanel Socket] Disconnected: ${e}`),N(!1),S(!1))})),o.on("connect_error",(e=>{v.current===o&&(console.error(`[ChatPanel Socket] \u8fde\u63a5\u9519\u8bef: ${e.message}, \u6b63\u5728\u5c1d\u8bd5\u91cd\u8fde...`),console.error("[ChatPanel Socket] Connection error:",e),N(!1),E(!0))}))})()):(console.log("[ChatPanel Effect] isOpen is false, disconnecting."),r()),()=>{e=!1,console.log("[ChatPanel Effect Cleanup] Component unmounting or dependencies changed."),v.current&&(console.log("[ChatPanel Effect Cleanup] Performing final disconnect."),r())}}),[t,null===l||void 0===l?void 0:l.id,p,n,q]),(0,o.useEffect)((()=>{i?v.current?console.log("[ChatPanel isOpen Effect] Panel opened, socket already exists/connecting."):console.log("[ChatPanel isOpen Effect] Panel opened and no socket, triggering connect logic (handled by main effect if dependencies match)."):v.current?(console.log("[ChatPanel isOpen Effect] Panel closed, triggering disconnect."),v.current.disconnect(),v.current=null,f(null),N(!1),S(!1)):console.log("[ChatPanel isOpen Effect] Panel closed, no socket to disconnect.")}),[i]),(0,o.useEffect)((()=>{const e=C.current;if(!e)return;const o=()=>{e.scrollTop<50&&D&&!$&&(()=>{var e;if(!v.current||!D||$||0===y.length)return;P(!0);const o=null===(e=y[0])||void 0===e?void 0:e.id;if(o){const e="topic"===n?`community_topic_${t}`:`community_relationship_topic_${t}`;console.log(`[ChatPanel Scroll] Requesting more history before message ID: ${o}`),v.current.emit("request_history",{room:e,limit:30,before_message_id:o})}else console.log("[ChatPanel Scroll] No oldest message ID found, cannot fetch more history."),P(!1)})()};return e.addEventListener("scroll",o),()=>{e.removeEventListener("scroll",o)}}),[y,D,$,t,n,q]);const W=()=>{if(B)return;const e="topic"===n?`community_topic_${t}`:`community_relationship_topic_${t}`;if(v.current&&b.trim()&&l&&t){O(!0);const t=b.trim(),n=t.toLowerCase().includes("@lynn"),o=`local_${Date.now()}_${Math.random().toString(36).substring(2)}`;console.log("[ChatPanel] Generated localId for preview:",o);const r={room:e,message:t,is_ai_mention:n,local_id:o};console.log("[ChatPanel] Sending message:",r);const s={id:o,userId:l.id,username:l.nickname||l.email,nickname:l.nickname,avatar:l.avatar,message:t,timestamp:(new Date).toISOString(),is_system_message:!1};w((e=>[...e,s])),setTimeout((()=>q("smooth")),100),j(""),v.current.emit("send_message",r,(e=>{O(!1),null!==e&&void 0!==e&&e.error?(console.error("[ChatPanel] Message send error:",e.error),m.oR.error(`\u53d1\u9001\u5931\u8d25: ${e.error}`),w((e=>e.filter((e=>e.id!==o))))):null!==e&&void 0!==e&&e.success&&e.message_id?(console.log("[ChatPanel] Message send success, confirmed ID:",e.message_id),e.message_id&&H.current.add(e.message_id)):console.warn("[ChatPanel] Message send response did not contain success or error confirmation.")}))}else v.current&&k?b.trim()?l?t||console.error("\u65e0\u6cd5\u53d1\u9001\u6d88\u606f: communityId \u672a\u63d0\u4f9b"):m.oR.error("\u8bf7\u5148\u767b\u5f55"):m.oR.warn("\u8bf7\u8f93\u5165\u6d88\u606f"):m.oR.error("\u804a\u5929\u670d\u52a1\u672a\u8fde\u63a5")};return(0,s.jsx)("div",{className:"w-full transition-opacity duration-700 ease-in-out mt-4 "+(i?"opacity-100":"opacity-0 pointer-events-none"),children:(0,s.jsxs)("div",{className:"w-full h-auto bg-transparent flex flex-col overflow-hidden",children:[(0,s.jsxs)("div",{ref:C,className:"overflow-y-auto p-4 bg-transparent space-y-3 h-[500px] relative transition-opacity duration-500 "+(R?"opacity-100":"opacity-0"),children:[$&&(0,s.jsx)("div",{className:"flex justify-center items-center py-2",children:(0,s.jsxs)("div",{className:"animate-pulse flex space-x-1",children:[(0,s.jsx)("div",{className:"h-1.5 w-1.5 bg-gray-400 rounded-full"}),(0,s.jsx)("div",{className:"h-1.5 w-1.5 bg-gray-400 rounded-full animation-delay-200"}),(0,s.jsx)("div",{className:"h-1.5 w-1.5 bg-gray-400 rounded-full animation-delay-400"})]})}),!D&&y.length>0&&(0,s.jsx)("div",{className:"text-center text-gray-500 text-xs py-2 animate-fade-in",children:"\u6ca1\u6709\u66f4\u65e9\u7684\u6d88\u606f\u4e86"}),!z&&R&&(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("div",{className:"text-gray-400 text-sm animate-pulse",children:"\u6b63\u5728\u8fde\u63a5..."})}),z&&(0,s.jsx)("div",{className:"space-y-3",children:0===y.length?(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsxs)("div",{className:"text-gray-500 text-sm animate-fade-in",children:["\u6b22\u8fce\u6765\u5230 ",r," \u8ba8\u8bba\u533a\uff01"]})}):y.map(((e,t)=>function(e,t){var n;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const r=e.userId===(null===l||void 0===l?void 0:l.id),i=e.is_system_message,a=e.id===(null===(n=y[y.length-1])||void 0===n?void 0:n.id)&&y.length>1&&_&&!e.id.startsWith("local_"),c=a?"animate-fade-in-up":o>=0?"animate-fade-in":"",d=o>=0?{animationDelay:`${Math.min(30*o,300)}ms`}:{};return(0,s.jsxs)("div",{className:`flex flex-col ${r?"items-end":"items-start"} ${c}`,style:d,children:[!r&&!i&&(0,s.jsxs)("div",{className:"flex items-center mb-1",children:[(0,s.jsx)("img",{src:e.avatar||"/default-avatar.png",alt:e.nickname||e.username||"\u7528\u6237",className:"w-5 h-5 rounded-full mr-3",onError:e=>e.currentTarget.src="/default-avatar.png"}),(0,s.jsx)("span",{className:"text-xs text-gray-400 font-medium",children:e.nickname||e.username||"\u533f\u540d\u7528\u6237"})]}),(0,s.jsx)("div",{className:"max-w-[85%] px-3 py-1.5 rounded-lg text-sm shadow-sm break-words "+(i?"bg-gradient-to-r from-purple-600/80 to-indigo-600/80 text-white rounded-bl-none self-start backdrop-blur-sm":r?"bg-indigo-600/70 text-white rounded-br-none self-end backdrop-blur-sm":"bg-teal-700/70 text-gray-100 rounded-bl-none self-start backdrop-blur-sm"),children:(0,s.jsx)("span",{children:e.message})}),e.timestamp&&(0,s.jsx)("span",{className:"text-xs text-gray-500 mt-1 px-1 "+(r?"self-end":"self-start"),children:g(e.timestamp)})]},e.id||t)}(e,t,!_?t:-1)))})]}),(0,s.jsx)("div",{className:"p-3 flex-shrink-0 border-t border-gray-700/50 transition-opacity duration-500 "+(R?"opacity-100":"opacity-0"),children:l?k?(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),W()},className:"flex items-center space-x-2 w-full",children:[(0,s.jsx)("input",{type:"text",value:b,onChange:e=>j(e.target.value),placeholder:"",disabled:!k||!l||B,className:"flex-grow px-3 py-1.5 bg-gray-900/40 border border-transparent rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500/60 text-gray-100 placeholder-gray-400 text-sm disabled:bg-gray-700/30 disabled:cursor-not-allowed",onKeyDown:e=>{(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&(e.preventDefault(),W())}}),(0,s.jsx)("button",{type:"submit",className:"p-1.5 rounded-md focus:outline-none transition-colors duration-200\n                            "+(k&&b.trim()&&l&&!B?"text-indigo-400 hover:text-indigo-300":"text-gray-500 cursor-not-allowed"),disabled:!k||!b.trim()||!l||B,children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M7 13l5 5 5-5M7 6l5 5 5-5"})})})]}):(0,s.jsx)("p",{className:"text-xs text-amber-400 text-center",children:"\u8ba8\u8bba\u670d\u52a1\u8fde\u63a5\u4e2d..."}):(0,s.jsxs)("p",{className:"text-xs text-yellow-600 text-center",children:["\u8bf7 ",(0,s.jsx)(c.N_,{to:"/login",className:"underline hover:text-yellow-700",children:"\u767b\u5f55"})," \u540e\u53c2\u4e0e\u8ba8\u8bba\u3002"]})})]})})},x=e=>{let{isLoading:t,error:n,topicDetails:r,posts:c,isLoadingPosts:d,parentType:m,parentSlug:u,showFavoriteButton:h=!1,isFavorited:g=!1,isLoadingFavorite:x=!1,onToggleFavorite:f=()=>{},onCreatePost:v=()=>{},showChatButton:y=!1,isChatAvailable:w=!1,children:b}=e;const{isSidebarOpen:j}=(0,l.c)(),[k,N]=(0,o.useState)(!1);return(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto transition-all duration-300 ease-in-out",children:[t&&(0,s.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,s.jsx)("p",{className:"text-gray-400",children:"\u6b63\u5728\u52a0\u8f7d\u5185\u5bb9..."})}),n&&!t&&(0,s.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,s.jsxs)("p",{className:"text-red-400",children:["\u9519\u8bef: ",n]})}),!t&&!n&&r&&(0,s.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-5",children:[(0,s.jsx)("div",{className:"lg:col-span-3",children:(0,s.jsx)("div",{className:"grid grid-cols-1 gap-5",children:d?(0,s.jsx)("p",{className:"text-center text-gray-400 py-10",children:"\u6b63\u5728\u52a0\u8f7d\u5e16\u5b50..."}):c.length>0?c.map((e=>(0,s.jsx)(a,{post:e,parentType:m,parentSlug:u},e.id))):(0,s.jsx)("p",{className:"text-center text-gray-400 py-10",children:"\u8fd9\u91cc\u8fd8\u6ca1\u6709\u5e16\u5b50\u3002"})})}),(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-5",children:[(0,s.jsx)(i,{name:r.name,description:r.description,slug:r.slug,id:r.id,isFavorited:g,onToggleFavorite:f,isLoadingFavorite:x}),(0,s.jsxs)("div",{className:"flex flex-row justify-start gap-2 flex-wrap",children:[(0,s.jsxs)("button",{onClick:v,className:"flex items-center justify-center px-3 py-1.5 rounded-md text-xs font-medium transition-colors duration-200                                   bg-gray-700/50 text-gray-300 hover:bg-gray-600/70                                   backdrop-blur-sm border border-gray-600/50",title:"\u53d1\u5e03\u65b0\u5e16\u5b50",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"\u65b0\u5e16\u5b50"]}),h&&(0,s.jsx)("button",{onClick:f,disabled:x,className:"flex items-center justify-center px-3 py-1.5 rounded-md text-xs font-medium transition-colors duration-200 backdrop-blur-sm border border-gray-600/50                                     "+(x?"opacity-50 cursor-not-allowed bg-gray-600/50 text-gray-400":g?"bg-yellow-500/60 text-yellow-100 hover:bg-yellow-600/70":"bg-gray-700/50 text-gray-300 hover:bg-gray-600/70"),children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin h-3.5 w-3.5 mr-1",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{children:"\u52a0\u8f7d"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),g?"\u5df2\u6536\u85cf":"\u6536\u85cf"]})}),y&&(0,s.jsxs)("button",{onClick:()=>N(!k),disabled:!w,className:"flex items-center justify-center px-3 py-1.5 rounded-md text-xs font-medium transition-colors duration-200                                     bg-[#CD5C5C]/50 text-gray-200 hover:bg-[#CD5C5C]/70                                     backdrop-blur-sm border border-gray-600/50                                     "+(w?"":"opacity-50 cursor-not-allowed"),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),"\u8ba8\u8bba"]})]}),k&&r&&(0,s.jsx)(p,{isOpen:k,onClose:()=>N(!1),communityId:r.id,communityType:"topic"===m?"topic":"relationship_topic",communityName:r.name})]})]})}),b]})}}}]);
//# sourceMappingURL=358.81943961.chunk.js.map